Microsoft (R) Macro Assembler Version 14.15.26730.0	    12/10/18 23:23:09
C:\Projects\REVIVAL\FDS\FILLERS\ZSCALE.ASM		     Page 1 - 1


				.386p
 00000000			_DATA   SEGMENT DWORD PUBLIC 'DATA'
				align 4
 00000000 00000000		du          dd  0
 00000004 00000000		StartX          dd  0
 00000008 00000000		StartY          dd  0
 0000000C 00000000		EndX            dd  0
 00000010 00000000		EndY            dd  0
 00000014 00000000		WidthX          dd  0
 00000018 00000000		Height          dd  0
 0000001C 00000000		ddx         dd  0
 00000020 00000000		ddy         dd  0
 00000024 00000000		Texture         dd  0
 00000028 00000000		Screen          dd  0
 0000002C 00000000		x           dd  0
 00000030 00000000		y           dd  0
 00000034 00000000		tx          dd  0
 00000038 00000000		ty          dd  0
 0000003C 00000000		ScanLine        dd  0
 00000040 00000000		Counter         dd  0
 00000044 00000000		TEBP            dd  0
 00000048 00000237		_ZScale_thatfucksBTB_Size	dd	ASM_FILE_END - _ZScale_thatfucksBTB_
				align 1
 004C				_DATA   ENDS

 00000000			_TEXT   SEGMENT BYTE PUBLIC 'CODE'
					ASSUME  cs:_TEXT, ds:_DATA

					PUBLIC  _ZScale_thatfucksBTB_Size

					PUBLIC  _ZScale_thatfucksBTB_
 00000000			_ZScale_thatfucksBTB_:
 00000000  89 2D 00000044 R	mov [TEBP],ebp
				;eax = x ebx = y ecx = size x edx = size y esi = Texture edi = Screen Buffer
 00000006  83 F9 00		cmp ecx,0
 00000009  0F 8E 00000221	jle ScalerEnd
 0000000F  83 FA 00		cmp edx,0
 00000012  0F 8E 00000218	jle ScalerEnd
 00000018  89 35 00000024 R	mov [Texture],esi
 0000001E  89 3D 00000028 R	mov [Screen],edi
 00000024  8B F0		mov esi,eax
 00000026  8B FB		mov edi,ebx
 00000028  2B F1		sub esi,ecx
 0000002A  2B FA		sub edi,edx
 0000002C  89 35 00000004 R	mov [StartX],esi
 00000032  89 3D 00000008 R	mov [StartY],edi
 00000038  03 C1		add eax,ecx
 0000003A  03 DA		add ebx,edx
 0000003C  A3 0000000C R	mov [EndX],eax
 00000041  89 1D 00000010 R	mov [EndY],ebx
 00000047  2B C6		sub eax,esi
 00000049  2B DF		sub ebx,edi
 0000004B  A3 00000014 R	mov [WidthX],eax
 00000050  89 1D 00000018 R	mov [Height],ebx
 00000056  8B C8		mov ecx,eax
 00000058  8B EB		mov ebp,ebx
 0000005A  B8 10000000		mov eax,10000000h
 0000005F  BA 00000000		mov edx,0
 00000064  F7 F1		div ecx
 00000066  A3 0000001C R	mov [ddx],eax
 0000006B  B8 10000000		mov eax,10000000h
 00000070  BA 00000000		mov edx,0
 00000075  F7 F5		div ebp
 00000077  A3 00000020 R	mov [ddy],eax
 0000007C  A1 00000004 R	mov eax,[StartX]
 00000081  8B 1D 00000008 R	mov ebx,[StartY]
 00000087  83 F8 00		cmp eax,0
 0000008A  7D 34		jge @@StartXOverZero
 0000008C  8B 2D 00000014 R	mov ebp,[WidthX]
 00000092  B8 00000000		mov eax,0
 00000097  8B 0D 00000004 R	mov ecx,[StartX]
 0000009D  C7 05 0000002C R	mov [x],0
	   00000000
 000000A7  03 E9		add ebp,ecx
 000000A9  2B C1		sub eax,ecx
 000000AB  89 2D 00000014 R	mov [WidthX],ebp
 000000B1  8B 0D 0000001C R	mov ecx,[ddx]
 000000B7  F7 E1		mul ecx
 000000B9  A3 00000034 R	mov [tx],eax
 000000BE  EB 0F		jmp @@CheckY
 000000C0			@@StartXOverZero:
 000000C0  A3 0000002C R	mov [x],eax
 000000C5  C7 05 00000034 R	mov [tx],0
	   00000000
 000000CF			@@CheckY:
 000000CF  83 FB 00		cmp ebx,0
 000000D2  7D 34		jge @@StartYOverZero
 000000D4  8B 2D 00000018 R	mov ebp,[Height]
 000000DA  B8 00000000		mov eax,0
 000000DF  8B 0D 00000008 R	mov ecx,[StartY]
 000000E5  C7 05 00000030 R	mov [y],0
	   00000000
 000000EF  03 E9		add ebp,ecx
 000000F1  2B C1		sub eax,ecx
 000000F3  89 2D 00000018 R	mov [Height],ebp
 000000F9  8B 0D 00000020 R	mov ecx,[ddy]
 000000FF  F7 E1		mul ecx
 00000101  A3 00000038 R	mov [ty],eax
 00000106  EB 10		jmp @@CheckEndX
 00000108			@@StartYOverZero:
 00000108  89 1D 00000030 R	mov [y],ebx
 0000010E  C7 05 00000038 R	mov [ty],0
	   00000000
 00000118			@@CheckEndX:
 00000118  A1 0000000C R	mov eax,[EndX]
 0000011D  8B 1D 00000010 R	mov ebx,[EndY]
 00000123  3D 00000140		cmp eax,320
 00000128  7C 19		jl @@CheckEndY
 0000012A  B8 00000140		mov eax,320
 0000012F  2B 05 0000002C R	sub eax,[x]
 00000135  A3 00000014 R	mov [WidthX],eax
 0000013A  83 F8 00		cmp eax,0
 0000013D  0F 8E 000000ED	jle ScalerEnd
 00000143			@@CheckEndY:

 00000143  81 FB 000000C8	cmp ebx,200
 00000149  7C 10		jl @@Setup
 0000014B  B8 000000C8		mov eax,200
 00000150  2B 05 00000030 R	sub eax,[y]
 00000156  A3 00000018 R	mov [Height],eax
 0000015B			@@Setup:
 0000015B  83 3D 00000014 R	cmp [WidthX],0
	   00
 00000162  0F 8E 000000C8	jle ScalerEnd
 00000168  83 3D 00000018 R	cmp [Height],0
	   00
 0000016F  0F 8E 000000BB	jle ScalerEnd

 00000175  A1 00000030 R	mov eax,[y]
 0000017A  8B 1D 0000002C R	mov ebx,[x]
 00000180  C1 E3 02		shl ebx,2
 00000183  C1 E0 08		shl eax,8
 00000186  03 D8		add ebx,eax
 00000188  C1 E0 02		shl eax,2
 0000018B  03 D8		add ebx,eax
 0000018D  03 1D 00000028 R	add ebx,[Screen]
 00000193  89 1D 0000003C R	mov [ScanLine],ebx
 00000199			@@Outer:
 00000199  A1 00000038 R	mov eax,[ty]
 0000019E  8B 1D 0000001C R	mov ebx,[ddx]
 000001A4  8B 3D 0000003C R	mov edi,[ScanLine]
 000001AA  C1 CB 14		ror ebx,20
 000001AD  25 0FF00000		and eax,0ff00000h
 000001B2  8A CB		mov cl,bl
 000001B4  C1 E8 0C		shr eax,12
 000001B7  B3 00		mov bl,0
 000001B9  8B 15 00000034 R	mov edx,[tx]
 000001BF  89 1D 00000000 R	mov [du],ebx
 000001C5  C1 CA 14		ror edx,20
 000001C8  8B 35 00000014 R	mov esi,[WidthX]
				;add eax,[Texture]
 000001CE  C1 E6 02		shl esi,2
 000001D1  8B 2D 00000024 R	mov ebp,[Texture]
 000001D7  8A C2		mov al,dl
 000001D9  8D 3C 37		lea edi,[edi+esi]
 000001DC  8A D1		mov dl,cl
 000001DE  83 F6 FF		xor esi,-1

 000001E1  46			inc esi
 000001E2			@@inner:
 000001E2  8B 4C 85 00		  mov ecx,[ebp+eax*4]
 000001E6  0B C9		  or ecx,ecx
 000001E8  74 03		  jz @@FuckBTB
 000001EA  89 0C 37		  mov [edi+esi],ecx
 000001ED			  @@FuckBTB:
 000001ED  03 15 00000000 R	  add edx,[du]
 000001F3  12 C2		  adc al,dl
 000001F5  83 C6 04		  add esi,4
 000001F8  75 E8		jnz @@inner

 000001FA  A1 0000003C R	mov eax,[ScanLine]
 000001FF  8B 1D 00000038 R	mov ebx,[ty]
 00000205  05 00000500		add eax,1280
 0000020A  8B 0D 00000020 R	mov ecx,[ddy]
 00000210  8B 15 00000018 R	mov edx,[height]
 00000216  03 D9		add ebx,ecx
 00000218  4A			dec edx
 00000219  89 1D 00000038 R	mov [ty],ebx
 0000021F  A3 0000003C R	mov [ScanLine],eax
 00000224  89 15 00000018 R	mov [height],edx
 0000022A  0F 85 FFFFFF69	jnz @@Outer

 00000230			ScalerEnd:
 00000230  8B 2D 00000044 R	mov ebp,[TEBP]
 00000236  C3			ret

 00000237 = 00000237		ASM_FILE_END	equ	$

 0237				_TEXT   ENDS

				END
Microsoft (R) Macro Assembler Version 14.15.26730.0	    12/10/18 23:23:09
C:\Projects\REVIVAL\FDS\FILLERS\ZSCALE.ASM		     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

_DATA  . . . . . . . . . . . . .	32 Bit	 004C	  DWord	  Public  'DATA'	
_TEXT  . . . . . . . . . . . . .	32 Bit	 0237	  Byte	  Public  'CODE'	


Symbols:

                N a m e                 Type     Value    Attr

@@CheckEndX  . . . . . . . . . .	L Near	 0118	  _TEXT	
@@CheckEndY  . . . . . . . . . .	L Near	 0143	  _TEXT	
@@CheckY . . . . . . . . . . . .	L Near	 00CF	  _TEXT	
@@FuckBTB  . . . . . . . . . . .	L Near	 01ED	  _TEXT	
@@Outer  . . . . . . . . . . . .	L Near	 0199	  _TEXT	
@@Setup  . . . . . . . . . . . .	L Near	 015B	  _TEXT	
@@StartXOverZero . . . . . . . .	L Near	 00C0	  _TEXT	
@@StartYOverZero . . . . . . . .	L Near	 0108	  _TEXT	
@@inner  . . . . . . . . . . . .	L Near	 01E2	  _TEXT	
ASM_FILE_END . . . . . . . . . .	Number	 0237h	 
Counter  . . . . . . . . . . . .	DWord	 0040	  _DATA	
EndX . . . . . . . . . . . . . .	DWord	 000C	  _DATA	
EndY . . . . . . . . . . . . . .	DWord	 0010	  _DATA	
Height . . . . . . . . . . . . .	DWord	 0018	  _DATA	
ScalerEnd  . . . . . . . . . . .	L Near	 0230	  _TEXT	
ScanLine . . . . . . . . . . . .	DWord	 003C	  _DATA	
Screen . . . . . . . . . . . . .	DWord	 0028	  _DATA	
StartX . . . . . . . . . . . . .	DWord	 0004	  _DATA	
StartY . . . . . . . . . . . . .	DWord	 0008	  _DATA	
TEBP . . . . . . . . . . . . . .	DWord	 0044	  _DATA	
Texture  . . . . . . . . . . . .	DWord	 0024	  _DATA	
WidthX . . . . . . . . . . . . .	DWord	 0014	  _DATA	
_ZScale_thatfucksBTB_Size  . . .	DWord	 0048	  _DATA	Public
_ZScale_thatfucksBTB_  . . . . .	L Near	 0000	  _TEXT	Public
ddx  . . . . . . . . . . . . . .	DWord	 001C	  _DATA	
ddy  . . . . . . . . . . . . . .	DWord	 0020	  _DATA	
du . . . . . . . . . . . . . . .	DWord	 0000	  _DATA	
tx . . . . . . . . . . . . . . .	DWord	 0034	  _DATA	
ty . . . . . . . . . . . . . . .	DWord	 0038	  _DATA	
x  . . . . . . . . . . . . . . .	DWord	 002C	  _DATA	
y  . . . . . . . . . . . . . . .	DWord	 0030	  _DATA	

	   0 Warnings
	   0 Errors
